


     
   
<script>



$(document).ready(function (e) {
	
	
	
    $("#vendorRegistrationForm").submit(function (e) {
console.log("//inside vendor registration form submit");
        ////alert("hello");
        var nameofvendor = $('#firstName').val();
        //alert(nameofvendor);
        var trainNoId = [];
        e.preventDefault();
        accesstoken = sessionStorage.getItem('key');
        var serializedReturn = $(this).serializeArray();
        //console.log("/////"+serializedReturn);
        var train = $("#trainsId").val();
        alert("train" + train);
        for (var k = 0; k < train.length; k++) {

            trainNoId[k] = parseInt(train[k]);
        }
        console.log(trainNoId);

        var loginFormObject = {};
        $.each(serializedReturn,
            function (i, v) {
                loginFormObject[v.name] = v.value;
            });
        loginFormObject["trainsId"] = trainNoId;
        //console.log(JSON.stringify(loginFormObject));
        $.ajax({
            url: "http://203.176.113.183/VendorAppServices/divisional/registernewvendor",
            method: "POST",

            headers: {
                "Authorization": "Bearer " + accesstoken,
                "Content-Type": "application/json"
            },
            data: JSON.stringify(loginFormObject),
            success: function (response) {
                ////alert("successfully register");
                //alert(response.message);

                $("#vendorRegistered").html(":" + response.message+ ":");

            },
            error: function (xhr, status) {
                if (xhr.status == '401') {
                  
                	  $("#vendorRegisterederror").html("Error :" +xhr.status+ "");
                    //alert("access denied, please refresh the page again");
                    refreshToken();
                }

            },

        });
        
       // document.getElementById("vendorRegistrationForm").reset();

    });


	
	
        var username = sessionStorage.getItem('username');
        checksession();
        fetchbasicdetails();

function fetchbasicdetails() {
 var accesstoken = sessionStorage.getItem('key');
 $.ajax({
         url: "http://203.176.113.183/VendorAppServices/divisional/userdetails/" + username,
                method: "GET",
                timeout: 0,
                headers: {
                    "Authorization": "Bearer " + accesstoken
                },
                success: function (response) { 
                    console.log(JSON.stringify(response));
                    $("#welcomeP").html("Welcome " + username + " Zone: " + response.zoneName + " Division: " + response.divName);
                    vendorcategorylist(); /// wait
                    vendorconstitutionlist();
                    trainlist();


                },
                error: function (xhr, status) {
                    if (xhr.status == '401') {
                        //	//alert("access denied, please refresh the page again fachebasicdetails");
                        refreshToken();
                       /*  sessionStorage.setItem('key', access_token);  */
                        fetchbasicdetails();
                     }
                }
            });
        }


        
async function commongetmethoderrorhandling(url)
 {
	 //alert(url);
	 response=commongetmoethod(url);//xhr.status
	  var response1=JSON.stringify(response);
	  console.log(JSON.stringify(response.status));
		console.log(JSON.stringify(response1));
    //alert("response.statuscode "+JSON.stringify(response));
  // //alert("xhr.status"+xhr.status);
    if(response1=="401" || response1=="400")
     {
       //alert("response :::::::::::::: "+response1);
       await refreshToken();
       response=commongetmoethod(url);
     }
    if(response1=="401" || response1=="400")
    {
     $(location).attr('href', window.location.pathname.substring(0, window.location.pathname.indexOf("/",2))+'/index.html');	

    }
    if(!response1=="401" || !response1=="400")
    {
    	$(location).attr('href', window.location.pathname.substring(0, window.location.pathname.indexOf("/",2))+'/index.html');	
	
    }
    
   
     return response
}

function commongetmoethod(url) {
////alert("commongetmethod :::"+url);
var accesstoken = sessionStorage.getItem('key');
var result='';
//alert("commongetmethod :accesstoken  ::  "+accesstoken);
$.ajax({
          url: url,
           method: "GET",
           timeout: 0,
           async:false,
           headers: {
                       "Authorization": "Bearer " + accesstoken
                      },
            success: function (response, xhr,status) {
            	if(xhr.status=='200'){
            	console.log(JSON.stringify(response.status));	
            	console.log(JSON.stringify(response));
            	}
                    result = response;
                   // //alert("------------"+xhr.status);
                    },
            error: function (xhr, status) {
            	if(xhr.status=='401'){
            		console.log("test5");
            		////alert("ffff"+vendorcategorylist);

            	} 
            	result = xhr.status;
                }
            });
       return result;
         }
  	
$("#logoutlink").on("click",function(){
	 sessionStorage.clear();
	 $(location).attr('href', window.location.pathname.substring(0, window.location.pathname.indexOf("/",2))+'/index.html');	
});
	
 
async function vendorcategorylist(){	
	////alert("vendorcategary");
var accesstoken = sessionStorage.getItem('key');
response=await commongetmethoderrorhandling("http://203.176.113.183/VendorAppServices/divisional/vendorcategorylist");
console.log(JSON.stringify(response));
$('#vendorCategoryId').empty();
$('#vendorCategoryId').append($('<option></option>').val("").html("---select---"));
$.each(response, function(i, p) {
$('#vendorCategoryId').append($('<option></option>').val(p.id).html(p.categoryName)); 
});
}

async function vendorconstitutionlist(){	
	////alert("vendorconstitutionlist");
var accesstoken = sessionStorage.getItem('key');
response=await commongetmethoderrorhandling("http://203.176.113.183/VendorAppServices/divisional/vendorconstitutionlist");	
console.log(JSON.stringify(response));
$('#vendorConstitutionId').empty();
$('#vendorConstitutionId').append($('<option></option>').val("").html("---Select---"));
$.each(response, function(i, p) {
$('#vendorConstitutionId').append($('<option></option>').val(p.id).html(p.constitutionName));
});	
}
 
async function trainlist(){	
//alert("trainlist");
var accesstoken = sessionStorage.getItem('key');
response=await commongetmethoderrorhandling("http://203.176.113.183/VendorAppServices/divisional/trainlist");	 
console.log(JSON.stringify(response));
//alert(sJSON.stringify(response));
$('#trainsId').empty();
$.each(response, function(i, p) {
    $('#trainsId').append($('<option></option>').val(p.id).html(p.trainNo+" - "+p.trainName));
    $('#trainsId').multiselect('rebuild');
    

});		  
}	 

 $('#trainsId').multiselect(
				{
					 includeSelectAllOption: true,
					 enableFiltering: true,
					 numberDisplayed: 3,

					});  
 
 
 
 
 $(function() {

	 $(".multiselect").on("click", function(e) {
	     $(".multiselect-container").addClass("show");
	     
	     e.stopPropagation()
	   });
	   $(document).on("click", function(e) {
	     if ($(e.target).is(".multiselect-container") === false) {
	       $(".multiselect-container").removeClass("show");
	     }
	   });
	 });
 
 
 
 
/*  
  $('.multiselect').click(function() {
  $('.multiselect-container').addClass("show");
});
   */
  
  
  

});


</script>

        <div class="row">
            <div class="col">
                <div class="shadow-lg ">
                   <div class="col-12 p-2 bg-white h-100 no-print"  >
                    <span style="color: #f05f40">*</span><span>Mandatory Fields</span>
                      
     	               <h5 class=" font-14 text-center vendorRegistered " id="vendorRegistered" style="color:green"></h5>
     	               <h5 class=" font-14 text-center vendorRegisterederror " id="vendorRegisterederror" style="color:red"></h5>
     	             
     	               </div>
                    <div class="text-light bg-danger text-center shadow-lg">Vendor Registration Form</div>
                    <form  method="post" id="vendorRegistrationForm" name="vendorRegistrationForm">
                   <!--  <form action="" class="was-validated"> -->
                        <div class=" row px-3 mx-3">
                            <div class=" col-md-4 ">
                                <div class="mb-3 mt-3">
                                   <span style="color: #f05f40">*</span>
                                    <label for="inputnameofvendor">First Name</label>
                                    <input type="text" class="form-control" id="firstName" name="firstName" placeholder="Name of Vendor" required >
                                     <div class="invalid-tooltip">Please username.</div>
                                  </div>
                           </div>
                       
                        <div class="col-sm-4 ">
                            <div class="mb-3 mt-3">
                                <label for="inputnameofvendor">Last Name</label>
                                <input type="text" class="form-control" id="lastName" name="lastName" placeholder="Last Name of Vendor">

                            </div>
                        </div>
                        <div class="col-sm-4 ">
                            <div class="mb-3 mt-3">
                                     <span style="color: #f05f40">*</span>
                                     <label for="inputpanoftheBusiness">Pan of the Business</label>
                                     <input type="text" class="form-control" id="vendorPan" name="vendorPan" placeholder="" required>
                                     <div class="invalid-tooltip">Please enter PAN number.</div>
                                </div>
                         </div>
                        </div>
                   
                    <div class="row px-3 mx-3 ">
                        <div class="col-sm-4 ">
                            <div class="mb-3 mt-3">
                                <span style="color: #f05f40">*</span>
                                    <label for="inputconstitution">Constitution of the Vendor</label>
                                    <div class="dropdown">
                                    <select id="vendorConstitutionId" name="vendorConstitutionId" class="form-control" required>
                                    </select>
                                </div>
                                <div class="invalid-tooltip">Please select vendor Constitution list.</div>
                            </div>
                        </div>
                        <div class="col-sm-4 ">
                            <div class="mb-3 mt-3">
                               
                                <label for="inputpanoftheBusiness">Vendor HSN Code</label>
                                <input type="text" class="form-control" id="vendorHsnCode" name="vendorHsnCode"
                                    placeholder="">
                                    
                            </div>
                        </div>
                        <div class="col-sm-4 ">
                            <div class="mb-3 mt-3">
                               
                                <label for="inputDetailsofgoods"> Details of Goods</label>
                                <input type="text" class="form-control" id="goodsDetails" name="goodsDetails"
                                    placeholder="">
                            </div>
                        </div>
                    </div>
                    <div class="row px-3 mx-3">
                        <div class="col-sm-4  ">
                            <div class="mb-3 mt-3">
                                <span style="color: #f05f40">*</span>
                                    <label for="inputcategoryofvendor">Category of Vendor </label>
                                    <select id="vendorCategoryId" name="vendorCategoryId" class="form-control" required>
                                    </select>
                                     <div class="invalid-tooltip">Please select vendor Category list.</div>
                                </div>
                               </div>
                        
                        <div class="col-sm-4 ">
                            <div class="container-fluid">
                                <span style="color: #f05f40">*</span>
                                     <label for="trainsId">Train Number</label>
                                     <div  class="mb-3 mt-3 custom-control border  ">
                                     <select class="" id="trainsId" name="trainsId"    multiple required>
                                    </select> 
                                      <div class="invalid-tooltip">Please select train list.</div>
                                    </div>
                                   
                                  </div>
                          </div>
                        
                        <div class="col-sm-4 ">
                            <div class="mb-3 mt-3">
                                  <span style="color: #f05f40">*</span>
                                     <label for="inputgstinBygov">GSTIN alloted by the Govt</label>
                                    <input type="number" class="form-control" id="gstin" name="gstin" required>
                                     <div class="invalid-tooltip">Please enter GSTIN .</div>
                                    </div>
                              </div>
                        </div>
                    
                    <div class="row px-3 mx-3">
                        <div class="col-sm-4 ">
                            <div class="mb-3 mt-3">
                             <span style="color: #f05f40">*</span>
                                      <label for="inputAddress">Address</label>
                                      <input type="text" class="form-control" id="address"  name="address" placeholder="please enter address" required>
                                      <div class="invalid-tooltip">Please enter address .</div>
                                
                                 </div>
                        </div>
                        <div class="col-sm-4  ">
                            <div class="mb-3 mt-3">
                                <span style="color: #f05f40">*</span>
                                    <label for="inputcontactno">Latest Contact No.</label>
                                     <input type="number" class="form-control" maxlength="10" pattern="([0-9])" id="contactNo" name="contactNo" required>
                                      <div class="invalid-tooltip">Please enter contact no .</div>
                             
                               </div>
                          </div>
                        <div class="col-sm-4 ">
                            <div class="mb-3 mt-3">
                                 <span style="color: #f05f40">*</span>
                                 <label for="inputemailId">Latest email-Id (if any)</label>
                                 <input type="email" class="form-control" id="email" name="email" required>
                                 <div class="invalid-tooltip">Please enter email-id .</div>
                                 
                             </div>
                        </div>
                   </div>

                    <div class="row px-3 mx-3">
                        <div class="col-sm-4">
                            <div class="mb-3 mt-3">
                             <label for="inputupiId">UPI ID</label>
                                <input type="text" class="form-control" id="upiId" name="upiId">
                            </div>
                        </div>
                        <div class="col-sm-4 ">
                            <div class="mb-3 mt-3">
                                <label for="inputbanAaccountNo">Bank Account Number</label>
                                <input type="text" class="form-control" id="bankAccountNo" name="bankAccountNo">
                           </div>
                        </div>
                        <div class="col-sm-4  ">
                            <div class="mb-3 mt-3">
                               <label for="inputbankBranchName">Bank Name</label>
                                <input type="text" class="form-control" id="bankName" name="bankName">
                            </div>
                        </div>
                   </div>
                   
                    <div class="row px-3 mx-3">
                        <div class="col-sm-4">
                            <div class="mb-3 mt-3">
                               <label for="inputbankBranchName">Bank Branch</label>
                                <input type="text" class="form-control" id="bankBranch" name="bankBranch">
                            </div>
                        </div>
                        <div class="col-sm-4 ">
                            <div class="mb-3 mt-3">
                               
                                <label for="inputifscCodes">IFSC</label>
                                <input type="text" class="form-control" id="bankIfsc" name="bankIfsc">
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="mb-3 mt-3">
                               
                                <label for="inputmicrNo">MICR</label>
                                <input type="text" class="form-control" id="bankMicr" name="bankMicr">
                            </div>
                        </div>

                    </div>


                    <div class="row px-3 mx-3">
                        <center class="col-lg-12 mb-3">
                            <button class="btn btn-lg btn-primary btn-block" type="submit">Submit</button>
                        </center>
                    </div>
                </form>
            </div>
        </div>
    </div>



