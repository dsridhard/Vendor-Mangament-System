<style>
 .close {
    float: right;
    font-size: 2rem;
    font-weight: 700;
    line-height: 1;
    color: #f05f40;
    text-shadow: 0 1px 0 #fff;
}
.closenotification {
    float: right;
   
    font-weight: 700;
    
}
button.close {
    padding: 0;
    background-color: transparent;
    border: 0;
    -webkit-appearance: none;
}

.notification-container {
  position: fixed;
  top: 15px;
  right: 15px;
  width: 500px;
  max-width: calc(100% - 30px);
}

.notification {
  background-color: #fff;
  border-radius: 5px;
  box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);
  color: #fff;
  font-size: 16px;
  padding: 15px 20px;
  line-height: 20px;
  margin-bottom: 15px;
  animation: grow 0.5s ease-in forwards;
}

@keyframes grow {
  from {
    opacity: 0;
    transform: scale(0.8);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.notification.hide {
  animation: shrink 0.3s ease-out forwards;
}

@keyframes shrink {
  to {
    opacity: 0;
    transform: scale(0.8);
  }
}

.notification strong {
  font-size: 12px;
  line-height: 20px;
  letter-spacing: 0.5px;
  text-transform: uppercase;
}

.notification-info {
  background-color: #00cae3;
}

 </style>
 
<body>
<div class="notification-container" id="notification-container">
  <div class="notification notification-info">
  <span class="closenotification remove" >X</span>
    <strong>Info:</strong> New Inquiry Arrived.
  </div>
  <div class="notification notification-info">
  <span class="closenotification remove" >X</span>
    <strong>Info:</strong> Lorem ipsum dolor sit amet2.
  </div>
  </div>
<div class="row">

<table id="tableID" class="table" style="width:100%">
<thead>
    <tr>
        <th>Service</th>
        <th>Sub Service</th>
        <th>Contact No</th>
        <th>Train No</th>
        <th>Station Name</th>
         <th>Passenger Name</th>
        <th>Date</th>
        <th>Status</th>
        <th>Supervisor</th>
        <th>Action</th>
        <th>hyrty</th>
    </tr>
</thead>
<tbody id="tbodyid">

           
</tbody>

</table>
<div class="modal fade" id="inquiryRemarksModal" tabindex="-1" role="dialog" aria-labelledby="inquiryRemarksModal" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Action</h5>
        <button type="button" class="close closeModal" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        	<div class=" row p-3 mx-3">
             		<div class=" col-md-12 ">
             			<label for="remarks"><b><span style="color: #f05f40">*</span>Remarks</b></label>
             		</div>
             		<div class=" col-md-12">
             			<input type="hidden" id="inquiryId" name="inquiryId">
             			<textarea id="remarks" name="remarks" rows="4" style="width:100%"></textarea>
             		</div>
             </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary closeModal" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" id="updateInquiryRemarks">Submit</button>
      </div>
    </div>
  </div>
</div>
<script>
$(document).ready(function() {
	
    fetchInquiries();
    var k=1;
    function fetchInquiries(){
        
    	
        var tbodyHtml="";
     commongetmethod("http://203.176.113.183/VendorAppServices/vendor/data/getvendorsupervisorstxnlist").then((response)=>{
             console.log(JSON.stringify(response));
             for(i=0;i<response.length;i++){
            	 tbodyHtml+="<tr>";
            	 if(response[i].serviceName==null){
            		 tbodyHtml+="<td>"+response[i].obhsTypeName+" </td>";
                	 }
            	 else{
            		 tbodyHtml+="<td>"+response[i].serviceName+" </td>";
                	 }
            	 if(response[i].subServiceName==null&&response[i].obhsSubTypeName!=null){
            		 tbodyHtml+="<td>"+response[i].obhsSubTypeName+" </td>";
                	 }
            	 else{
            		 tbodyHtml+="<td>"+response[i].subServiceName+" </td>";
                	 }

            	 
                 tbodyHtml+= "<td>"+response[i].mobileNo+" </td>"+
                 "<td>"+response[i].trainNo+" </td>"+
                 "<td>"+response[i].stationName+" </td>"+
                 "<td>"+response[i].psgnName+" </td>"+
                 "<td>"+response[i].txnDateTime+" </td>"+
                 "<td>"+response[i].inquiryStatusName+" </td>"+
                 "<td>"+response[i].pendingWith+" </td>";
                 if(response[i].inquiryStatusName!="Inquiry Closed")
                	 tbodyHtml+= "<td><button type='button' class='btn btn-sm btn-outline-success updatestatus' id='"+response[i].transactionId+"' >Close</button> </td>";
                	 else
                    	 tbodyHtml+= "<td></td>";


                  if((response[i].pendingWith.split("_")).length==3)  
                	  tbodyHtml+="<td>1 </td>";
                  else
                	  tbodyHtml+="<td>0</td>";
                 	 
                	 tbodyHtml+="</tr>";
                          
                 }
        	 $('#tableID').DataTable().destroy();
             
    	 $("#tbodyid").html(tbodyHtml);
    	 var t= $('#tableID').DataTable( {
    		 
	       "bDestroy":true,
	       /* "stateSave": true,*/
	       order: [[10, 'desc'],[6, 'desc']],
	      'columnDefs' : [
	           //hide the second & fourth column
	           { 'visible': false, 'targets': [10] }
	       ]  
	        } );
	    	
	    	 t.draw(false);
    	
    	if(k==1){
    		createInquiryInterval();
        	}
    	k=2;
         })
         .fail((xhr,status)=>{
        	 if(xhr.status=="401"){
         		  refreshToken().then((res) => {
         	        	console.log(res);
         	        	setSessionStorageItems(res);
         	        	fetchInquiries();
         	           });
         		  }
             });
    	
    }


    $("#tbodyid").on('click','.updatestatus',function(){

          //alert($(this).attr("id"));
          var btnid=$(this).attr("id");
          $('#remarks').val("");
          $('#inquiryId').val(btnid);
          $('#inquiryRemarksModal').modal("show");
          });
    $(".closeModal").on('click',function(){
        $('#remarks').val("");
        $('#inquiryId').val("");
        $('#inquiryRemarksModal').modal("hide");
      });
    $("#updateInquiryRemarks").on('click',function(){
    	var id = $('#inquiryId').val();
    	var remarks = $('#remarks').val();
    	alert(JSON.stringify({id:id,remarks:remarks}));
  /*   	 commongetmethod("http://203.176.113.183/VendorAppServices/vendor/data/submitvendortxn/"+$(this).attr("id")).then((response)=>{
                              alert(response.message);
                             console.log(JSON.stringify(response));
                             fetchInquiries();

              })
              .fail((xhr,status)=>{
            	  if(xhr.status=="401"){
             		  refreshToken().then((res) => {
             	        	console.log(res);
             	        	setSessionStorageItems(res);
             	        	$('#'+btnid)[0].click();
             	           });
             		  }
                  }); */
    });

   
    
    function createInquiryInterval(){
        //alert("timer created");
    	window.inquiryIntervalTimer=setInterval(function(){
    		 fetchInquiries();
    	       
    	      
    	     }, 10000);
    	
    }
    
});
const notificationContainer = document.getElementById('notification-container');
addNotification();
$('.remove').click(function() {
    $(this).parent().remove();
  });
  
function addNotification() {
    // create the DIV and add the required classes
    const newNotification = document.createElement('div');
    newNotification.classList.add('notification', 'notification-info');

    const innerNotification = "<strong>Info:</strong>New Inquiry Arrived";

    // insert the inner elements
    newNotification.innerHTML ="<span class='closenotification remove' >X</span>" +innerNotification;

    // add the newNotification to the container
    notificationContainer.appendChild(newNotification);

   // return newNotification;
}
</script>


</div>
</body>