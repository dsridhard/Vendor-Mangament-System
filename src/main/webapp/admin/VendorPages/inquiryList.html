
 
<body>
<div class="row">

<table id="tableID" class="table" style="width:100%">
<thead>
    <tr>
        <th>Service</th>
        <th>Sub Service</th>
        <th>Contact No</th>
        <th>Train No</th>
        <th>Station Name</th>
         <th>Passenger Name</th>
        <th>Date</th>
        <th>Status</th>
        <th>Supervisor</th>
        <th>Action</th>
    </tr>
</thead>
<tbody id="tbodyid">

           
</tbody>

</table>

<script>
$(document).ready(function() {
	
    fetchInquiries();
    function fetchInquiries(){
    	$('#tableID').DataTable().destroy();
        var tbodyHtml="";
     commongetmethod("http://203.176.113.183/VendorAppServices/vendor/data/getvendorsupervisorstxnlist").then((response)=>{
             console.log(JSON.stringify(response));
             for(i=0;i<response.length;i++){
            	 tbodyHtml+="<tr>";
            	 if(response[i].serviceName==null){
            		 tbodyHtml+="<td>"+response[i].obhsTypeName+" </td>";
                	 }
            	 else{
            		 tbodyHtml+="<td>"+response[i].serviceName+" </td>";
                	 }
            	 if(response[i].subServiceName==null&&response[i].obhsSubTypeName!=null){
            		 tbodyHtml+="<td>"+response[i].obhsSubTypeName+" </td>";
                	 }
            	 else{
            		 tbodyHtml+="<td>"+response[i].subServiceName+" </td>";
                	 }

            	 
                 tbodyHtml+= "<td>"+response[i].mobileNo+" </td>"+
                 "<td>"+response[i].trainNo+" </td>"+
                 "<td>"+response[i].stationName+" </td>"+
                 "<td>"+response[i].psgnName+" </td>"+
                 "<td>"+response[i].txnDateTime+" </td>"+
                 "<td>"+response[i].inquiryStatusName+" </td>"+
                 "<td>"+response[i].pendingWith+" </td>";
                 if(response[i].inquiryStatusName!="Inquiry Closed")
                	 tbodyHtml+= "<td><button type='button' class='btn btn-sm btn-outline-success updatestatus' id='"+response[i].transactionId+"' >Close</button> </td>";
                	 else
                    	 tbodyHtml+= "<td></td>";
                 	 
                	 tbodyHtml+="</tr>";
                          
                 }
           
    	 $("#tbodyid").html(tbodyHtml);
    	 
    	 var t= $('#tableID').DataTable( {
	       "bDestroy":true
	        } );
	    	
	    	 t.draw();
    	
    	
         })
         .fail((xhr,status)=>{
        	 if(xhr.status=="401"){
         		  refreshToken().then((res) => {
         	        	console.log(res);
         	        	setSessionStorageItems(res);
         	        	fetchInquiries();
         	           });
         		  }
             });
    	
    }


    $("#tbodyid").on('click','.updatestatus',function(){

          //alert($(this).attr("id"));
          var btnid=$(this).attr("id");
          commongetmethod("http://203.176.113.183/VendorAppServices/vendor/data/submitvendortxn/"+$(this).attr("id")).then((response)=>{
                              alert(response.message);
                             console.log(JSON.stringify(response));
                             fetchInquiries();

              })
              .fail((xhr,status)=>{
            	  if(xhr.status=="401"){
             		  refreshToken().then((res) => {
             	        	console.log(res);
             	        	setSessionStorageItems(res);
             	        	$('#'+btnid)[0].click();
             	           });
             		  }
                  });

        });
    
});




</script>


</div>
</body>